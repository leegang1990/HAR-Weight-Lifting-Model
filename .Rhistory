summary(model_A2)
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all,direction="both",steps=2000))
model_A2 <- stepAIC(fit_all, scope=c(lower=fit_min, upper=fit_all,direction="both",steps=2000))
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all,direction="both",steps=2000))
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all,direction="forward",steps=2000))
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all,direction="both"))
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all,directions="both"))
model_A2 <- stepAIC(fit_min, scope=c(lower=fit_min, upper=fit_all),direction="both")
model_A2 <- step(fit_min, scope=c(lower=fit_min, upper=fit_all),direction="both")
summary(model_A2)
?step()
model_A2 <- step(fit_min, scope=list(upper=~., lower=~1),direction="both")
model_A2 <- step(fit_all, scope=list(upper=~., lower=~1),direction="both")
summary(model_A2)
summary(model_A2)$adj.R.squared
coefficients(model_A2)
var(model_A2)
summary(model_A2)$adj.r.square
model_A3 <- glm(formula = mpg ~ wt + qsec + am, data = mtcars)
summary(model_A3)
model_A3 <- lm(formula = mpg ~ wt + qsec + am, data = mtcars)
summary(model_A3)
model_A4 <- lm(formula = mpg ~ wt + qsec + am +hp, data = mtcars)
summary(model_A4)
table(cor(mtcars))
cor(mtcars)
cor(mtcars[1,])
sort(cor(mtcars)[1,])
head(mtcars)
?cor()
data(mtcars)
sort(cor(mtcars)[1,])
cor(mtcars)
table(cor(mtcars))
library("GGally")
ggpairs(cdat1)
library("datasets")
data("mtcars")
cdat1 <- mtcars
cdat1$vs <- as.factor(as.character(cdat1$vs))
cdat1$am <- as.factor(as.character(cdat1$am))
ggpairs(cdat1)
?ggpairs()
ggpairs(data=cdat1, columns = c(1,9))
?ggpairs()
ggpairs(data=cdat1, columns = c(1:9), lower = "smooth")
ggpairs(data=cdat1, columns = c(1:9), lower = list(continuous ="smooth"))
levels(cdat1$am)
?mtcars
?ggpairs
ggpairs(data=cdat1, columns = c(1:9), lower = list(continuous ="smooth_loess"))
ggpairs(data=cdat1, lower = list(continuous ="smooth", params = c(colour = "blue")))
model_A <- lm(mpg~.,mtcars)
summary(model_A)
lm_A <- lm(mpg~.,mtcars)
fit_A <- lm(mpg~.,mtcars)
library("MASS")
fit_A <- lm(mpg~.,mtcars)
model_A <- stepAIC(fit_A, direction = "both")
summary(model_A)
model_A <- stepAIC(fit_A, direction = "both", trace =0)
summary(model_A)
lm_B <- lm(mpg~wt+am+qsec+hp, data=mtcars)
AIC(lm_B)
lm_B <- lm(mpg~wt+am+qsec, data=mtcars)
AIC(lm_B)
lm_all <- lm(mpg~.,data=mtcars)
AIC(lm_all)
lm_C <- lm(mpg~(wt+qsec)*am, data=mtcars)
AIC(lm_C)
summary(lm_C)
anova(lm_A,lm_C)
anova(lm_B,lm_C)
lm_A <- lm(mpg~wt+qsec+am, data=mtcars)
lm_B <- lm(mpg~wt+hp+am, data=mtcars)
lm_C <- lm(mpg~(wt+qsec)*am, data=mtcars)
lm_D <- lm(mpg~(wt+hp)*am, data=mtcars)
AIC(lm_A)
AIC(lm_B)
AIC(lm_C)
AIC(lm_D)
anova(lm_A,lm_B)
anova(lm_A,lm_C)
anova(lm_B,lm_D)
summary(lm_C)
library("car")
outlierTest(lm_C)
par(mfrow=c(2,2))
plot(lm_C)
plot(lm_A)
plot(lm_C)
plot(lm_A)
plot(lm_C)
lm_all <- lm(mpg~.,data=mtcars)
plot(lm_all)
plot(lm_C)
lm_allin <- lm(mpg~.*.,data=mtcars)
plot(lm_allin)
plot(lm_C)
AIC(lm_all)
AIC(lm_C)
summary(lm_A)$adj.r,square
summary(lm_A)$adj.r.squared
summary(lm_B)$adj.r.squared
summary(lm_C)$adj.r.squared
summary(lm_D)$adj.r.squared
AIC(lm_C)
extractAIC(lm_C)
extractAIC(lm_A)
extractAIC(lm_B)
extractAIC(lm_D)
lm_E <- lm(mpg~wt+am+disp, mtcars)
summary(lm_E)
extractAIC(lm_E)
stepAIC(lm_all)
lm_E <- lm(mpg~wt+am+disp+hp+qsec, mtcars)
summary(lm_E)
plot(lm_E)
par(mfrow=c(2,2))
plot(lm_E)
plot(lm_E)
par(mfrow=c(2,2))
plot(lm_E)
plot(lm_C)
plot(lm_E)
summary(lm_A)
summary(lm_A)
summary(lm_A)
summary(lm_A)
summary(lm_E)
summary(lm_C)
str(mtcars)
library("datasets")
data("mtcars")
mtcars$vs <- as.factor(as.character(mtcars$vs))
mtcars$am <- as.factor(as.character(mtcars$am))
str(mtcars)
fit_A <- lm(mpg~.,mtcars)
model_A <- stepAIC(fit_A, direction = "both", trace =0)
summary(model_A)
extractAIC(model_A)
par(mfrow=c(2,2))
plot(model_A)
outlierTest(model_A)
par(mfrow=c(2,2))
plot(model_A)
outlierTest(model_A)
model_B <- lm(mpg~(wt+qsec)*am, data=mtcars)
summary(model_B)
extractAIC(model_B)
?mtcars
anova(model_A, model_B)
head(mtcars[1:9,])
head(mtcars[,1:9])
library(rmarkdown)
library(knitr)
library(markdown)
render("Regression_Models_Project_Assignment.Rmd")
render("Regression Models Project Assignment.Rmd")
render("Regression Models Project Assignment.md")
install.packages("installr")
install.packages("caret", dependencies = TRUE)
?install.packages
install.packages("AppliedPredictiveModeling")
install.packages("ElemStatLearn")
install.packages("pgmm")
install.packages("rpart")
install.packages("gbm")
install.packages("lubridate")
install.packages("forecast")
install.packages("e1071")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
library(ElemStatLearn)
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
fit1 <- train(y~., method="rf", data=vowel.train)
library(caret)
set.seed(33833)
fit1 <- train(y~., method="rf", data=vowel.train)
fit2 <- train(y~., method="gbm", data=vowel.train)
pred1 <- predict(fit1$finalModel,data=vowel.test)
pred2 <- predict(fit2$finalModel, data=vowel.test)
pred2 <- predict(fit2, data=vowel.test)
pred1 <- predict(fit1,data=vowel.test)
confusionMatrix(pred2,vowel.test$y)
confusionMatrix(pred1,vowel.test$y)
str(pred1)
str(vowel.train)
fit1$finalModel
fit2$finalModel
str(pred1)
dim(pred1)
str(pred2)
pred2 <- predict(fit2$finalModel, data=vowel.test)
fit1
fit2
varImp(fit1)
varImp(fit2)
pred1 <- predict(fit1$finalModel,vowel.test)
str(pred1)
head(pred1)
pred2 <- predict(fit2$finalModel,vowel.test,n.trees = 150)
pred2 <- predict(fit2$finalModel,data=vowel.test,n.trees = 150)
fit2$finalModel
fit2 <- train(y~., data=vowel.train, method = "gbm")
fit2 <- train(y~., data=vowel.train, method = "gbm", verbose =FALSE)
fit1 <- train(y~., data=vowel.train, method = "rf", verbose =FALSE)
pred1 <- predict(fit1$finalModel,data=vowel.test, "raw")
pred1 <- predict(fit1$finalModel,newdata=vowel.test)
pred1 <- predict(fit1$finalModel,newdata=vowel.test, "raw")
pred1 <- predict(fit1$finalModel,newdata=vowel.test)
pred1
pred2 <- predict(fit2$finalModel,newdata=vowel.test)
fit2$finalModel
fit2
pred2 <- predict(fit2$finalModel,newdata=vowel.test,n.trees = 150)
head(pred2)
pred2 <- predict(fit2$finalModel,newdata=vowel.test,n.trees = 150,"raw")
pred2 <- predict(fit2,newdata=vowel.test,n.trees = 150)
head(pred2)
pred2
str(pred2)
pred1
confusionMatrix(pred1,vowel.test$y)
confusionMatrix(pred2,vowel.test$y)
set.seed(33833)
fit1 <- train(y~., data=vowel.train, method = "rf", verbose =FALSE)
fit2 <- train(y~., data=vowel.train, method = "gbm", verbose =FALSE)
pred1 <- predict(fit1$finalModel,newdata=vowel.test)
pred2 <- predict(fit2,newdata=vowel.test,n.trees = 150)
confusionMatrix(pred1,vowel.test$y)
confusionMatrix(pred2,vowel.test$y)
confusionMatrix(pred1,pred2)
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
fit_rf <- train(diagnosis~., data=training, method ="rf")
str(training)
fit_gbm <- train(diagnosis~., data=training, method ="gbm", verbose=FALSE)
fit_lda <- train(diagnosis~., data=training, method = "lda")
install.packages("MASS")
pred_rf <- predict(fit_rf, newdata=testing)
pred_gbm <- predict(fit_gbm, newdata=testing)
pred_lda <- predict(fit_lda, newdata=testing)
confusionMatrix(pred_rf,testing$diagnosis)
confusionMatrix(pred_gbm,testing$diagnosis)
confusionMatrix(pred_lda,testing$diagnosis)
predt_rf <- predict(fit_rf, newdata=training)
predt_gbm <- predict(fit_gbm, newdata=training)
predt_lda <- predict(fit_lda, newdata=training)
stacked_dat <- as.data.frame(predt_rf,predt_gbm,predt_lda,training$diagnosis)
stacked_dat <- cbind(predt_rf,predt_gbm,predt_lda,training$diagnosis)
str(stacked_dat)
head(stacked_dat)
stacked_dat <- as.data.frame(stacked_dat)
str(stacked_dat)
fit_stacked <- train(V4~.,data=stacked_dat,method="rf")
?caretStack
fit_stacked
stacked_test <- cbind(pred_rf,pred_gbm,pred_lda,testing$diagnosis)
stacked_test <- as.data.frame(stacked_test)
pred_stacked <- predict(fit_stacked, newdata=stacked_test)
names(stacked_test)
names(stacked_test)[1]
names(stacked_test)[1]<- "predt_rf"
names(stacked_test)[2]<- "predt_gbm"
names(stacked_test)[3]<- "predt_lda"
names(stacked_test)
pred_stacked <- predict(fit_stacked, newdata=stacked_test)
confusionMatrix(pred_stacked,testing$diagnosis)
pred_stacked
head(stacked_dat)
str(stacked_dat)
stacked_dat$predt_rf <- as.factor(stacked_dat$predt_rf)
stacked_dat$predt_gbm <- as.factor(stacked_dat$predt_gbm)
stacked_dat$predt_lda <- as.factor(stacked_dat$predt_lda)
stacked_dat$V4 <- as.factor(stacked_dat$V4)
stacked_test$predt_rf <- as.factor(stacked_test$predt_rf)
stacked_test$predt_gbm <- as.factor(stacked_test$predt_gbm)
stacked_test$predt_lda <- as.factor(stacked_test$predt_lda)
stacked_test$V4 <- as.factor(stacked_test$V4)
fit_stacked <- train(V4~.,data=stacked_dat,method="rf")
fit_stacked
pred_stacked <- predict(fit_stacked, newdata=stacked_test)
pred_stacked
confusionMatrix(pred_stacked,testing$diagnosis)
head(testing)
head(testing$diagnosis,10)
pred_stacked[pred-stacked==1]<-"Control"
testing$diagnosis[testing$diagnosis=="Control"]<-1
levels(pred_stacked)
levels(pred_stacked) <- c("Control","Impaired")
pred_stacked
confusionMatrix(pred_stacked,testing$diagnosis)
s-test <- data.frame(pred_rf,pred_gbm,pred_lda,diagnosis=testing$diagnosis)
s_test <- data.frame(pred_rf,pred_gbm,pred_lda,diagnosis=testing$diagnosis)
fit_s <- train(diagnosis~., data=s_test, method="rf")
set.seed(33833)
mod_rf <- train(y ~ ., data = vowel.train, method = "rf")
mod_gbm <- train(y ~ ., data = vowel.train, method = "gbm")
pred_rf <- predict(mod_rf, vowel.test)
pred_gbm <- predict(mod_gbm, vowel.test)
confusionMatrix(pred_rf, vowel.test$y)$overall[1]
confusionMatrix(pred_gbm, vowel.test$y)$overall[1]
confusionMatrix(pred_rf, pred_gbm)$overall[1]
library(caret)
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
fit_rf <- train(diagnosis~., method = "rf", data=training, verbose = FALSE)
fit_gbm <- train(diagnosis~., method = "gbm", data=training, verbose = FALSE)
fit_lda <- train(diagnosis~., method = "lda", data=training, verbose = FALSE)
pred_rf <- predict(fit_rf,newdata=testing)
pred_gbm <- predict(fit_gbm,newdata=testing)
pred_lda <- predict(fit_lda,newdata=testing)
stacked <- data.frame(pred_rf,pred_gbm,pred_lda,diagnosis=testing$diagnosis)
sfit <- train(diagnosis~., method="rf", data=stacked)
sfit$summary
sfit$finalModel
sfit
spred <- predict(sfit, newdata = stacked)
confusionMatrix(spred,testing$diagnosis)
confusionMatrix(pred_rf,testing$diagnosis)
confusionMatrix(pred_gbm,testing$diagnosis)
confusionMatrix(pred_lda,testing$diagnosis)
library(caret)
set.seed(3523)
library(AppliedPredictiveModeling)
data(concrete)
inTrain = createDataPartition(concrete$CompressiveStrength, p = 3/4)[[1]]
training = concrete[ inTrain,]
testing = concrete[-inTrain,]
str(training)
set.seed(233)
fit_lasso <- train(CompressiveStrength~.,method="lasso",data=training)
fit_lasso <- train(CompressiveStrength~.,method="lasso",data=training)
set.seed(233)
fit_lasso <- train(CompressiveStrength~.,method="lasso",data=training)
?plot.enet
varImp(fit_lasso)
plot.enet(fit_lasso)
fit_lasso
fit_lasso$finalModel
?enet
plot.enet(fit_lasso$finalModel)
library(lubridate) # For year() function below
dat = read.csv("~/Desktop/gaData.csv")
training = dat[year(dat$date) < 2012,]
testing = dat[(year(dat$date)) > 2011,]
tstrain = ts(training$visitsTumblr)
wd()
get.wd()
getwd()
dat = read.csv("C:/Users/leegang/Desktop/gaData.csv")
training = dat[year(dat$date) < 2012,]
testing = dat[(year(dat$date)) > 2011,]
tstrain = ts(training$visitsTumblr)
library(forecast)
str(tstrain)
head(tstrain)
?bats
fit_ts <- bats(tstrain)
pred_ts ,- predict(fit_ts,newdata=testing
pred_ts <- predict(fit_ts,newdata=testing)
pred_ts2 <- predict(fit_ts,newdata = ts(testing$visitsTumblr)))
pred_ts2 <- predict(fit_ts,newdata = ts(testing$visitsTumblr))
identical(pred_ts,pred_ts2)
fit_ts
confusionMatrix(pred_ts,testing$visitsTumblr)
confusionMatrix(pred_ts,ts(testing$visitsTumblr))
pred_ts <- forecast(fit_ts,data=testing, level=95)
pred_ts
fit_ts
summary(fit_ts)
pred_ts <- forecast(fit_ts,data=testing, level=95, h=235)
confusionMatrix(pred_ts,testing$visitsTumblr)
mean(as.numeric(ts(testing$visitsTumblr)) < pred_ts$upper[,2] & as.numeric(ts(testing$visitsTumblr)) > pred_ts$lower[,2])
pred_ts$upper
mean(as.numeric(ts(testing$visitsTumblr)) < pred_ts$upper & as.numeric(ts(testing$visitsTumblr)) > pred_ts$lower)
set.seed(3523)
library(AppliedPredictiveModeling)
data(concrete)
inTrain = createDataPartition(concrete$CompressiveStrength, p = 3/4)[[1]]
training = concrete[ inTrain,]
testin
testing <- concrete[-inTrain,]
library(e1071)
set.seed(325)
fit_svm <- train(CompressiveStrength~.,method="svm", data=training)
fit_svm <- train(CompressiveStrength~.,method="svmRadial", data=training)
?svm
fit_svm2 <- svm(CompressiveStrength~., data=training)
pred_svm2 <- predict(fit_svm2, newdata=testing)
confusionMatrix(pred_svm2,testing$CompressiveStrength)
head(pred_svm2)
head(testing$CompressiveStrength)
summary(pred_svm2)
rmse(pred_svm2)
RMSE(pred_svm2)
RMSE(pred_svm2,testing$CompressiveStrength)
getwd()
setwd("C:/Users/leegang/Desktop/Rwd/ML Model")
library(caret)
raw_training <- read.csv("pml training.csv")
raw_testing <- read.csv("pml testing.csv")
set.seed(1234)
inTrain <- createDataPartition(raw_training$classe, p=0.8, list = FALSE)
training <- raw_training[inTrain,]
cval <- raw_training[-inTrain,]
newdat <- training[, colMeans(is.na(training)) <= .50]
zerovar_list <- nearZeroVar(newdat)
newdat1 <- newdat[,-zerovar_list]
head(newdat1)
xlist <- findCorrelation(newdat1)
cor_mat <- cor(newdat1)
newdat2 <- newdat1[,-(1:6)]
cor_mat <- cor(newdat2)
allnum <- sapply(newdat2,as.numeric)
str(allnum)
head(allnum)
cormat <- cor(allnum)
findCorrelation(cormat)
names(allnum)
ctraining <- newdat1[,-(1:6)]
ncol(ctraining)
names(ctraining)
head(ctraining)
fit_rpart <- train(classe~.,method="rpart",data=ctraining)
fit_rpart
ctraining2 <- preProcess(ctraining)
fit_rpart <- train(classe~.,method="rpart",data=ctraining2)
sc_trans <- preProcess(ctraining)
ctraining2 <- predict(sc_trans,ctraining)
fit_rpart <- train(classe~.,method="rpart",data=ctraining2)
fit_rpart
head(ctraining2)
fit_rpart <- train(classe~.,method="lda",data=ctraining2)
fit_lda <- fit_rpart
fit_lda
fit_lda$finalModel
cval_trans <- predict(sc_trans,cval)
pred_lda <- predict(fit_lda,cval_trans)
confusionMatrix(pred_lda,cval$classe)
fit-rf <- train(classe~., method ="rf", data=ctraining2)
trcontrol <- trainControl(method="repeatedcv", number=10, repeats=3)
control <- trainControl(method="repeatedcv", number=10, repeats=3)
fit-rf <- train(classe~., method ="rf", data=ctraining2, trControl = control)
control <- trainControl(method="repeatedcv", number=5, repeats=3)
fit-rf2 <- train(classe~., method ="rf", data=ctraining2, trControl = trcontrol, do.trace = TRUE)
control <- trainControl(method="cv", number=5, ntrees = 300)
control <- trainControl(method="cv", number=5)
fit-rf2 <- train(classe~., method ="rf", data=ctraining2, trControl = trcontrol, do.trace = TRUE)
fit_svm <- train(classe~., method="svmRadial", data=ctraining2)
fit_svm <- train(classe~., method="xgboost", data=ctraining2)
fit_svm <- train(classe~., method="xgbtree", data=ctraining2)
fit_svm <- train(classe~., method="xgbTree", data=ctraining2)
fit_svm <- train(classe~., method="xgbTree", data=ctraining2, do.trace = TRUE)
control <- trainControl(method="cv", number=5, verboseIter = TRUE,
returnData=FALSE,
returnResamp = "all",
allowParallel = TRUE)
fit_svm <- train(classe~., method="xgbTree", data=ctraining2, trControl = control)
control <- trainControl(method="cv", number=3, nrounds =100, verboseIter = TRUE,
returnData=FALSE,
returnResamp = "all",
allowParallel = TRUE)
control <- trainControl(method="cv", number=3, verboseIter = TRUE,
returnData=FALSE,
returnResamp = "all",
allowParallel = TRUE)
fit_svm <- train(classe~., method="xgbTree", data=ctraining2, trControl = control)
fit_xgb <- train(classe~., method="xgbTree", data=ctraining2, trControl = control)
fit_xgb
pred_xgb <- predict(fit_xgb,cval_trans)
confusionMatrix(pred_xgb,cval$classe)
test_trans <- predict(sc_trans,testing)
test_trans <- predict(sc_trans,raw_testing)
pred_test_xgb <- predict(fit_xgb,test_trans)
confusionMatrix(pred_test_xgb,test_trans$classe)
head(pred_test_xgb)
pred_test_xgb
varImp(fit_xgb)
fit_xgb <- train(classe~., method="xgbTree", data=ctraining2, trControl = control)
confusionMatrix(pred_lda,sc_cval$classe)
confusionMatrix(pred_lda,cval$classe)
confusionMatrix(pred_lda,cval$classe)$Accuracy
?confusionMatrix(pred_lda,cval$classe)
?confusionMatrix(pred_lda,cval$classe)$overall
confusionMatrix(pred_lda,cval$classe)$overall
confusionMatrix(pred_lda,cval$classe)$overall[[1]]
names(ctraining)
names(raw_training)
